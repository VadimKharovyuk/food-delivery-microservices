<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π - Food Delivery</title>
</head>
<body>
<h1>üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π</h1>

<!-- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ -->
<div id="messages">
    <!-- Thymeleaf —Å–æ–æ–±—â–µ–Ω–∏—è -->
    <div th:if="${success}" style="color: green; background: #e8f5e8; padding: 10px; margin: 10px 0; border: 1px solid green;">
        ‚úÖ <span th:text="${success}"></span>
    </div>

    <div th:if="${error}" style="color: red; background: #ffe8e8; padding: 10px; margin: 10px 0; border: 1px solid red;">
        ‚ùå <span th:text="${error}"></span>
    </div>
</div>

<!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
<h2>‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h2>
<form action="/test/categories/create" method="post" enctype="multipart/form-data" style="border: 1px solid #ccc; padding: 20px; margin: 20px 0;">

    <div style="margin-bottom: 10px;">
        <label for="name"><strong>–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:</strong></label><br>
        <input type="text" id="name" name="name" required maxlength="100" style="width: 300px; padding: 5px;">
    </div>

    <div style="margin-bottom: 10px;">
        <label for="description"><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong></label><br>
        <textarea id="description" name="description" maxlength="500" rows="3" style="width: 300px; padding: 5px;"></textarea>
    </div>

    <div style="margin-bottom: 10px;">
        <label for="imageFile"><strong>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</strong></label><br>
        <input type="file" id="imageFile" name="imageFile" accept="image/*">
        <small style="color: gray;">–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (JPG, PNG, GIF)</small>
    </div>

    <div style="margin-bottom: 10px;">
        <label for="sortOrder"><strong>–ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:</strong></label><br>
        <input type="number" id="sortOrder" name="sortOrder" value="0" style="width: 100px; padding: 5px;">
    </div>

    <div style="margin-bottom: 10px;">
        <label>
            <input type="checkbox" name="isActive" value="true" checked>
            <strong>–ê–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è</strong>
        </label>
    </div>

    <button type="submit" style="background: #4CAF50; color: white; padding: 10px 20px; border: none; cursor: pointer;">
        ‚ûï –°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
    </button>
</form>

<!-- –°–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
<h2>üìã –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>

<div th:if="${categories != null and not #lists.isEmpty(categories)}">
    <p><strong>–í—Å–µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:</strong> <span th:text="${#lists.size(categories)}"></span></p>

    <div style="border: 1px solid #ddd; margin: 20px 0;">
        <div th:each="category : ${categories}" style="border-bottom: 1px solid #eee; padding: 15px;">

            <div style="display: flex; align-items: flex-start; gap: 20px;">

                <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                <div style="flex-shrink: 0;">
                    <div th:if="${category.imageUrl != null}">
                        <img th:src="${category.imageUrl}" th:alt="${category.name}"
                             style="width: 120px; height: 90px; object-fit: cover; border: 1px solid #ddd;">
                    </div>
                    <div th:unless="${category.imageUrl != null}"
                         style="width: 120px; height: 90px; background: #f5f5f5; border: 1px solid #ddd; display: flex; align-items: center; justify-content: center; color: #999;">
                        –ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    </div>
                </div>

                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                <div style="flex-grow: 1;">
                    <h3 style="margin: 0 0 10px 0; color: #333;">
                        <span th:text="${category.name}"></span>
                        <span th:if="${!category.isActive}" style="color: red; font-size: 0.8em;">(–ù–ï–ê–ö–¢–ò–í–ù–ê–Ø)</span>
                    </h3>

                    <p style="margin: 5px 0; color: #666;" th:if="${category.description != null and !category.description.isEmpty()}">
                        <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> <span th:text="${category.description}"></span>
                    </p>

                    <div style="display: flex; gap: 15px; font-size: 0.9em; color: #888;">
                        <span><strong>ID:</strong> <span th:text="${category.id}"></span></span>
                        <span><strong>–ü–æ—Ä—è–¥–æ–∫:</strong> <span th:text="${category.sortOrder}"></span></span>
                        <span><strong>–°–æ–∑–¥–∞–Ω–∞:</strong> <span th:text="${#temporals.format(category.createdAt, 'dd.MM.yyyy HH:mm')}"></span></span>
                    </div>
                </div>

                <!-- –î–µ–π—Å—Ç–≤–∏—è -->
                <div style="flex-shrink: 0;">
                    <form th:action="@{/test/categories/delete/{id}(id=${category.id})}" method="post"
                          style="display: inline;"
                          onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é \'' + '[[${category.name}]]' + '\'?')">
                        <button type="submit" style="background: #f44336; color: white; padding: 5px 10px; border: none; cursor: pointer; font-size: 0.9em;">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div th:if="${categories == null or #lists.isEmpty(categories)}" style="text-align: center; padding: 40px; color: #999;">
    <h3>üì≠ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
    <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å –ø–æ–º–æ—â—å—é —Ñ–æ—Ä–º—ã –≤—ã—à–µ.</p>
</div>

<!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ -->
<hr style="margin: 40px 0;">
<h2>üîß –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</h2>

<details style="margin: 20px 0;">
    <summary style="cursor: pointer; font-weight: bold;">üìä API Endpoints</summary>
    <div style="background: #f5f5f5; padding: 15px; margin: 10px 0;">
        <p><strong>GET</strong> <code>/test/categories</code> - –≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞</p>
        <p><strong>POST</strong> <code>/test/categories/create</code> - –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</p>
        <p><strong>POST</strong> <code>/test/categories/delete/{id}</code> - –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</p>
        <p><strong>GET</strong> <code>/test/categories/api</code> - JSON —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</p>
    </div>
</details>

<details style="margin: 20px 0;">
    <summary style="cursor: pointer; font-weight: bold;">üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏</summary>
    <div style="background: #f5f5f5; padding: 15px; margin: 10px 0;">
        <ol>
            <li>–°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</li>
            <li>–°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º</li>
            <li>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –±–æ–ª—å—à–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</li>
            <li>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç</li>
            <li>–°–æ–∑–¥–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É</li>
            <li>–£–¥–∞–ª–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª–∏–ª–æ—Å—å –∏–∑ Cloudinary</li>
        </ol>
    </div>
</details>

<!-- JSON API –¥–ª—è AJAX —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
<div style="margin: 20px 0;">
    <button onclick="loadCategoriesJson()" style="background: #2196F3; color: white; padding: 10px 15px; border: none; cursor: pointer;">
        üìä –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —á–µ—Ä–µ–∑ API
    </button>
    <div id="jsonResult" style="background: #f9f9f9; padding: 10px; margin: 10px 0; border: 1px solid #ddd; display: none;">
        <pre id="jsonContent"></pre>
    </div>
</div>

<script>
    function loadCategoriesJson() {
        fetch('/test/categories/api')
            .then(response => response.json())
            .then(data => {
                document.getElementById('jsonContent').textContent = JSON.stringify(data, null, 2);
                document.getElementById('jsonResult').style.display = 'block';
            })
            .catch(error => {
                document.getElementById('jsonContent').textContent = '–û—à–∏–±–∫–∞: ' + error.message;
                document.getElementById('jsonResult').style.display = 'block';
            });
    }

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    setTimeout(() => {
        const messages = document.getElementById('messages');
        if (messages) {
            messages.style.opacity = '0.5';
        }
    }, 5000);
</script>

<footer style="margin-top: 50px; padding: 20px; background: #f5f5f5; text-align: center; color: #666;">
    <p>üß™ <strong>–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</strong> - Food Delivery Product Service</p>
    <p>–î–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ REST API endpoints</p>
</footer>

</body>
</html>